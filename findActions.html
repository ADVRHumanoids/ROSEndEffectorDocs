

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FindActions &mdash; ROSEndEffector 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ROS End-Effector GUI" href="roseeGui.html" />
    <link rel="prev" title="ROS End-Effector Grasping Actions" href="actions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ROSEndEffector
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">How to use ROS End-Effector with your End-Effector</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Ready to use examples with tested hands</a></li>
</ul>
<p class="caption"><span class="caption-text">The Main Component</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="actions.html">ROS End-Effector Grasping Actions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">FindActions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#primitives">Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generic-actions-the-custom-ones">Generic Actions (the custom ones)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timed-actions">Timed Actions</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Other Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="roseeGui.html">ROS End-Effector GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="roseeGazeboPlugin.html">ROS End-Effector Gazebo Plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Possible Issues</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="googleTests.html">How to run the google tests present in the package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ROSEndEffector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>FindActions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/findActions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="findactions">
<span id="id1"></span><h1>FindActions<a class="headerlink" href="#findactions" title="Permalink to this headline">¶</a></h1>
<p><strong>TODO</strong> put link to api doc for the classes</p>
<div class="section" id="primitives">
<h2>Primitives<a class="headerlink" href="#primitives" title="Permalink to this headline">¶</a></h2>
<p>The <strong>FindActions</strong> class will help you to extract automatically the primitive actions that the loaded end-effector can accomplish. Each kind of primitive has its own method to understand if a primitive is doable and how (i.e. which joints moves and in which position).</p>
<p>In brief, the pinch actions (PinchTight, PinchLoose, MultiplePinchTight) are found looking for collisions between the fingertips. A high number of random end-effector configurations (i.e. joint positions) is explored, and the configurations where the <em>best</em> collisions are found are stored. This is done with the help of some <em>Moveit</em> functionalities.
The other kind of primitives are found exploring the kinematic tree of the models. For example, a trig is found selecting all the joints of a finger (if some are present).</p>
<p>The selected configurations for each primitive are then stored in classes. The classes themselves will be in charge of emitting the yaml file (one file per primitive), that can be parsed during the online phase. Also the parsing is done with the methods of the primitives.</p>
<p>In the following part, we will explore the <em>UniversalFindActions</em> node, to understand how to use the <strong>FindActions</strong> class. The complete code is avaiable at (TODO put link). Here only the essential parts are descripted.</p>
<p>First, we need to init the ros node, fill the parameter with the urdf and srdf file (this is necessary because Moveit reads these files from there):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ros</span><span class="o">::</span><span class="n">init</span> <span class="p">(</span> <span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="s">&quot;FindActions&quot;</span> <span class="p">);</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>

<span class="n">ROSEE</span><span class="o">::</span><span class="n">Parser</span> <span class="n">parser</span><span class="p">(</span><span class="n">nh</span><span class="p">);</span>
<span class="n">parser</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>

<span class="n">nh</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">&quot;robot_description&quot;</span><span class="p">,</span> <span class="n">parser</span><span class="p">.</span><span class="n">getUrdfString</span><span class="p">());</span>
<span class="n">nh</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">&quot;robot_description_semantic&quot;</span><span class="p">,</span> <span class="n">parser</span><span class="p">.</span><span class="n">getSrdfString</span><span class="p">());</span>
</pre></div>
</div>
<p>A special class, <em>ParserMoveit</em> is in charge of exctrating information from the model, so we need to init it prior to pass it to the FindActions class:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span> <span class="o">&lt;</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ParserMoveIt</span><span class="o">&gt;</span> <span class="n">parserMoveIt</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span> <span class="o">&lt;</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ParserMoveIt</span><span class="o">&gt;</span> <span class="p">();</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">parserMoveIt</span><span class="o">-&gt;</span><span class="n">init</span> <span class="p">(</span><span class="s">&quot;robot_description&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
  <span class="n">ROS_ERROR_STREAM</span> <span class="p">(</span><span class="s">&quot;FAILED parserMoveit Init, stopping execution&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ROSEE</span><span class="o">::</span><span class="n">FindActions</span> <span class="n">actionsFinder</span> <span class="p">(</span><span class="n">parserMoveIt</span><span class="p">);</span>
</pre></div>
</div>
<p>Now we can call the various find**** to look for the primitives. These functions will return the actions as c++ maps, but also they will create the yaml files and fill them.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span> <span class="n">maps</span> <span class="o">=</span> <span class="n">actionsFinder</span><span class="p">.</span><span class="n">findPinch</span><span class="p">(</span><span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span> <span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionTrig</span><span class="o">&gt;</span> <span class="n">trigMap</span> <span class="o">=</span>  <span class="n">actionsFinder</span><span class="p">.</span><span class="n">findTrig</span> <span class="p">(</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionPrimitive</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">Trig</span><span class="p">,</span>  <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span><span class="p">)</span> <span class="p">;</span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span> <span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionTrig</span><span class="o">&gt;</span> <span class="n">tipFlexMap</span> <span class="o">=</span> <span class="n">actionsFinder</span><span class="p">.</span><span class="n">findTrig</span> <span class="p">(</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionPrimitive</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">TipFlex</span><span class="p">,</span> <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span> <span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionTrig</span><span class="o">&gt;</span> <span class="n">fingFlexMap</span> <span class="o">=</span> <span class="n">actionsFinder</span><span class="p">.</span><span class="n">findTrig</span> <span class="p">(</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionPrimitive</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">FingFlex</span><span class="p">,</span> <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span><span class="p">);</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nFinger</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span> <span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionSingleJointMultipleTips</span><span class="o">&gt;</span> <span class="n">singleJointMultipleTipsMap</span> <span class="o">=</span> <span class="n">actionsFinder</span><span class="p">.</span><span class="n">findSingleJointMultipleTips</span> <span class="p">(</span><span class="n">nFinger</span><span class="p">,</span> <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span><span class="p">)</span> <span class="p">;</span>

<span class="n">nFinger</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span> <span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionSingleJointMultipleTips</span><span class="o">&gt;</span> <span class="n">singleJointMultipleTipsMap2</span> <span class="o">=</span> <span class="n">actionsFinder</span><span class="p">.</span><span class="n">findSingleJointMultipleTips</span> <span class="p">(</span><span class="n">nFinger</span><span class="p">,</span> <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span><span class="p">)</span> <span class="p">;</span>

<span class="k">auto</span> <span class="n">mulPinch</span> <span class="o">=</span> <span class="n">actionsFinder</span><span class="p">.</span><span class="n">findMultiplePinch</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span> <span class="p">);</span>
</pre></div>
</div>
<p>As said, each find**** will return the action from where information about the primitive can be get. But, in general, we want to call the find**** only once during the offline phase, and then parse the emitted yaml files during the initialization of the online phase.</p>
<p>So, in the same file, there are examples on how these action can be parsed.
First, a MapActionHandler must be created. This is a support class that internally can parse all primitives (or only some, if wanted):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ROSEE</span><span class="o">::</span><span class="n">MapActionHandler</span> <span class="n">mapsHandler</span><span class="p">;</span>
<span class="n">mapsHandler</span><span class="p">.</span><span class="n">parseAllPrimitives</span><span class="p">(</span><span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/primitives/&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>We can then call mapsHandler methods to take a single action. We can take a primitive both by its name (e.g. “pinchTight”), or by its type (e.g. ROSEE::ActionPrimitive::Type::Trig):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span> <span class="n">pinchTightParsed</span> <span class="o">=</span> <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitiveMap</span><span class="p">(</span><span class="s">&quot;pinchTight&quot;</span><span class="p">);</span>

<span class="k">auto</span> <span class="n">trigParsed</span> <span class="o">=</span> <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitiveMap</span><span class="p">(</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionPrimitive</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">Trig</span><span class="p">);</span>
</pre></div>
</div>
<p>If the action is not found (i.e. the yaml file is not present) the function simply return an empty map and print an error.
The returned map are of type <code class="code docutils literal notranslate"><span class="pre">typedef</span> <span class="pre">std::map</span> <span class="pre">&lt;</span> <span class="pre">std::set</span> <span class="pre">&lt;</span> <span class="pre">std::string</span> <span class="pre">&gt;,</span> <span class="pre">ROSEE::ActionPrimitive::Ptr</span> <span class="pre">&gt;</span> <span class="pre">ActionPrimitiveMap</span></code>.
The key contains one or more string to select the specific primitive among the one of same type. For example, for a tightPinch, each key is a set containing two strings: the names of the fingers that colllide.
For example:</p>
<table border="1" class="colwidths-given docutils" id="id2">
<caption><span class="caption-text">TightPinch Example</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>[Thumb, Index]</td>
<td>The TightPinch primitive which makes thumb and index to collide</td>
</tr>
<tr class="row-odd"><td>[Thumb, Ring]</td>
<td>The TightPinch primitive which makes thumb and ring to collide</td>
</tr>
</tbody>
</table>
<p>The number of element in the set depends obviously on the type of the primitive, for example a trig has only one element, the multiPinchTight_3 will have three elements.</p>
<p>The value is a pointer to ActionPrimitive class, which has some simply get methods to extract the essential information about the action, for example <code class="code docutils literal notranslate"><span class="pre">getJointPos()</span></code></p>
</div>
<div class="section" id="generic-actions-the-custom-ones">
<h2>Generic Actions (the custom ones)<a class="headerlink" href="#generic-actions-the-custom-ones" title="Permalink to this headline">¶</a></h2>
<p>The same file also shows how it is possible to create custom actions in the code.
We can create a custom action <em>summing</em> two previously created actions (primitives, or other composed actions), thanks to the <code class="code docutils literal notranslate"><span class="pre">sumAction()</span></code> function. This function simply combine the actions <strong>summing</strong> the joint positions:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitiveMap</span><span class="p">(</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionPrimitive</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">Trig</span><span class="p">).</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="o">&amp;&amp;</span>
    <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitiveMap</span><span class="p">(</span><span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionPrimitive</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">Trig</span><span class="p">).</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="n">parserMoveIt</span><span class="o">-&gt;</span><span class="n">getNFingers</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>

  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;A composed action with Independent inner action: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionComposed</span> <span class="n">grasp</span> <span class="p">(</span><span class="s">&quot;grasp&quot;</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">trig</span> <span class="p">:</span> <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitiveMap</span><span class="p">(</span><span class="s">&quot;trig&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">grasp</span><span class="p">.</span><span class="n">sumAction</span>  <span class="p">(</span><span class="n">trig</span><span class="p">.</span><span class="n">second</span><span class="p">)</span> <span class="p">;</span>
  <span class="p">}</span>
  <span class="n">grasp</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>
</pre></div>
</div>
<p>If we want to emit the yaml file about this action, we are now us in charge of call the right function:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">yamlWorker</span><span class="p">.</span><span class="n">createYamlFile</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">grasp</span><span class="p">,</span> <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/generics/&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>We can then parse all the generics with the mapsHandler used before for the primitives:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">mapsHandler</span><span class="p">.</span><span class="n">parseAllGenerics</span> <span class="p">(</span><span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/generics/&quot;</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;PARSED COMPOSEd&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">mapsHandler</span><span class="p">.</span><span class="n">getGeneric</span><span class="p">(</span><span class="s">&quot;grasp&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span>
</pre></div>
</div>
<p>Note that the above example creates a <code class="code docutils literal notranslate"><span class="pre">ActionComposed</span></code> object, namely a class that is created <em>summing</em> two or more actions. We can also create a generic action from scratch, manually filling the essential structures</p>
<p>So, first we fill the ROSEE::JointPos and ROSEE::JointsInvolvedCount structures. In the below example, we will copy inside them information from other actions:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ROSEE</span><span class="o">::</span><span class="n">JointPos</span> <span class="n">jp</span><span class="p">;</span>

<span class="c1">//for now copy jp of another action</span>
<span class="n">jp</span> <span class="o">=</span> <span class="n">ROSEE</span><span class="o">::</span><span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="n">maps</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">getJointPos</span><span class="p">(),</span> <span class="mi">2</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">jpc</span> <span class="o">=</span> <span class="n">maps</span><span class="p">.</span><span class="n">first</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">getJointsInvolvedCount</span><span class="p">();</span>

<span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionGeneric</span> <span class="n">simpleAction</span><span class="p">(</span><span class="s">&quot;casual&quot;</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jpc</span><span class="p">);</span>

<span class="c1">//always remember to emit it...</span>
<span class="n">yamlWorker</span><span class="p">.</span><span class="n">createYamlFile</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">simpleAction</span><span class="p">,</span>  <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/generics/&quot;</span> <span class="p">);</span>

<span class="n">mapsHandler</span><span class="p">.</span><span class="n">parseAllGenerics</span> <span class="p">(</span><span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/generics/&quot;</span><span class="p">);</span> <span class="c1">//NOTE already called before</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The parsed casual: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="n">mapsHandler</span><span class="p">.</span><span class="n">getGeneric</span><span class="p">(</span><span class="s">&quot;casual&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span>
</pre></div>
</div>
<p>You can also fill the structure inserting key+value in the map. The ROSEE::JointsInvolvedCount is a
<code class="code docutils literal notranslate"><span class="pre">typedef</span> <span class="pre">std::map</span> <span class="pre">&lt;std::string,</span> <span class="pre">unsigned</span> <span class="pre">int&gt;</span> <span class="pre">JointsInvolvedCount</span></code>, where the value must be 0 or 1: 1 if the joint is used in the action, 0 otherwise. The key is the name of the joint.</p>
<p><strong>It is important</strong> to have all actuated joints as keys in both ROSEE::JointsInvolvedCount and ROSEE::JointPos</p>
</div>
<div class="section" id="timed-actions">
<h2>Timed Actions<a class="headerlink" href="#timed-actions" title="Permalink to this headline">¶</a></h2>
<p>These kind of actions are created similarly to generic ones. The difference is that here we execute the action that we add <em>one after the other</em>, so we do not <em>sum</em> the joint positions. An example is always in the same file:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitive</span><span class="p">(</span><span class="s">&quot;singleJointMultipleTips_3&quot;</span><span class="p">,</span> <span class="s">&quot;left_hand_Finger_Spread&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="k">nullptr</span> <span class="o">&amp;&amp;</span>
    <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitive</span><span class="p">(</span><span class="s">&quot;pinchTight&quot;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="s">&quot;left_hand_c&quot;</span><span class="p">,</span> <span class="s">&quot;left_hand_q&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="k">nullptr</span> <span class="p">)</span> <span class="p">{</span>

  <span class="n">ROSEE</span><span class="o">::</span><span class="n">ActionTimed</span> <span class="n">actionTimed</span> <span class="p">(</span><span class="s">&quot;timed_random&quot;</span><span class="p">);</span>

  <span class="n">actionTimed</span><span class="p">.</span><span class="n">insertAction</span><span class="p">(</span> <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitive</span><span class="p">(</span><span class="s">&quot;singleJointMultipleTips_3&quot;</span><span class="p">,</span> <span class="s">&quot;left_hand_Finger_Spread&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">&quot;SPREAD&quot;</span><span class="p">);</span>

  <span class="n">actionTimed</span><span class="p">.</span><span class="n">insertAction</span><span class="p">(</span> <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getPrimitive</span><span class="p">(</span><span class="s">&quot;pinchTight&quot;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="s">&quot;left_hand_c&quot;</span><span class="p">,</span> <span class="s">&quot;left_hand_q&quot;</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;PINCH&quot;</span><span class="p">);</span>

  <span class="n">actionTimed</span><span class="p">.</span><span class="n">print</span><span class="p">();</span>

  <span class="n">yamlWorker</span><span class="p">.</span><span class="n">createYamlFile</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">actionTimed</span><span class="p">,</span> <span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/timeds/&quot;</span> <span class="p">);</span>
  <span class="n">mapsHandler</span><span class="p">.</span><span class="n">parseAllTimeds</span><span class="p">(</span><span class="n">folderForActions</span> <span class="o">+</span> <span class="s">&quot;/timeds/&quot;</span><span class="p">);</span>

  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The timed action parsed: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="n">mapsHandler</span><span class="p">.</span><span class="n">getTimed</span><span class="p">(</span><span class="s">&quot;timed_random&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="code docutils literal notranslate"><span class="pre">insertAction(...)</span></code> function will insert the action at the end of the queue. Check the API for further information.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="roseeGui.html" class="btn btn-neutral float-right" title="ROS End-Effector GUI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="actions.html" class="btn btn-neutral float-left" title="ROS End-Effector Grasping Actions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Luca Muratore, Davide Torielli

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>